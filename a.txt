方案初稿
车载网络的信息安全-建立于CAN总线的入侵检测系统

1.项目实施的目的及必要性
1.1车载网络安全问题的来源
如今的智能汽车以建立起LIN、CAN/CANFD、MOST、FlexRay、Ethernet多种总线技术和协议组合而搭建的复杂汽车电子网络系统。CAN总线是目前使用最广泛的车载网络总线技术，CAN总线针对控制系统的需求设计，缺乏信息安全防护机制和手段。
1.1.1 CAN总线当前面临的安全隐患
（1）点到线的传播，机密性差；
（2）传播的消息源不完整；
（3）总线的脆弱性。
  1.1.2 CAN总线的信息安全问题
      CAN总线的设计未考虑信息安全问题，对信息安全要求的五个方面都难以保证：
（1）机密性：CAN总线网络中车内电控单元以广播形式传输明文形式的报文，未对数据进行加密。
（2）真实性：CAN总线消息以唯一确定标识符ID进行接收和发送，总线协议没有关于发送端身份的任何认证。
（3）有效性：CAN总线使用载波监听/冲突避免（CSMA/CA）的冲裁方法，保证高优先级消息获得发送权，当恶意节点持续发送高优先级消息，没有相关策略保证其他消息按时发送。
（4）完整性：通过CRC对报文消息进行验证，可能被恶意节点通过计算制造虚假的CRC校验码消息，造成汽车功能失效。
（5）无否认性：总线中任何节点都可以发送任何报文ID的数据帧到总线网络中，没有方法能够使连接在总线上的节点证明是否发送或者接收过一个给定的消息。
1.2必要性
目前已有研究通过在CAN总线上实施密钥管理、身份认证、消息认证等防御机制来保护CAN总线的信息安全，然而，受车载CAN总线协议特性及车载实施环境制约，在车载总线网络环境下应用加密和认证等安全技术手段具有相当大的困难。异常检测通过对网络中的可疑行为进行判断和报警来保障系统的安全，可以弥补认证、加密等防御措施的不足，因此研究适合车载CAN总线的异常（入侵）检测技术成为必需。
1.3入侵检测方法
基于规则的检测技术/基于签名的方法

基于学习的检测技术
机器学习：支持向量机、决策树、深度学习、神经网络

机器学习中对于处理的数据形式：包的形式：分析数据量大，速度慢；
流的形式，分析速度快，损失部分细节，适合数据量大的环境。

国外数据集，加拿大2017： https://www.unb.ca/cic/datasets/ids-2017.html

技术受到的硬件限制和要求
车载设备计算和存储能力受限，对决策错误容忍极低，连接车辆的安全架构需要高度的可伸缩性，满足不断增长的新终端需求；汽车使用寿命长且很难改变车载硬件资源。

一、入侵检测系统分为 异常入侵检测系统 和 误用入侵检测系统

异常入侵检测系统是指记录某种状态下的系统运行行为，将其定义为正常行为。对系统运行进行实时监测，一旦发现与正常行为在超过某个阈值的不匹配的特征，便进行报警。误用入侵检测系统是指定义恶意行为。对系统进行实时监测，一旦发现与定义的恶意行为匹配的行为，便进行报警。

模式	方法分类	模式	方法分类
异常入侵检测系统	基于特征选择的异常检测方法	误用入侵检测系统	基于条件概率的误用入侵检测
	基于贝叶斯推理的异常检测		基于状态迁移分析的误用入侵检测
	基于贝叶斯网络的异常检测		基于键盘监控的误用入侵检测
	基于统计的异常检测方法		基于规则的误用入侵检测方法
	基于模式预测的异常检测方法		
	基于机器学习的异常检测方法		
	基于数据挖掘的异常检测方法		
	基于应用模式的异常检测方法		
	基于文本分类的异常检测方法		

模式	优势	劣势
异常入侵检测系统	准确率高	要识别所有的攻击特征，就要建立完备的特征库
	算法简单	特征库要不断更新
		无法检测新的入侵
误用入侵检测系统	可检测未知攻击	对用户知识要求较高，配置、操作和管理使用较为复杂
	自适应、自学习能力	对入侵检测系统的处理性能要求越来越高，现有技术难以满足实际需要
		高虚警率，用户处理的负担重
		由于警告信息记录的不完整，许多警告信息可能无法与入侵行为相关联，难以得到有用的结果
		在应对对自身的攻击时，对其他数据的检测也可能会被抑制或受到影响

误用检测技术
建立入侵行为模型(攻击特征)
假设可以识别和表示所有可能的特征
基于系统和基于用户的误用
异常检测技术

设定“正常”的行为模式
假设所有的入侵行为是异常的
基于系统和基于用户的异常


异常入侵检测容易出现误报，而误用入侵检测容易出现漏报。这取决于所使用的特征数据库。将两者结合使用也不失为一种折衷的办法。

IDS入侵检测系统是一个旁路监听设备，没有也不需要跨接在任何链路上，无须网络流量流经它便可以工作。因此，对IDS的部署的唯一要求就是：IDS应当挂接在所有所关注流量都必须流经的链路上。
IDS的接入方式：并行接入(并联)
IDS在交换式网络中的位置一般选择为：尽可能靠近攻击源，尽可能靠近受保护资源
这些位置通常是：服务器区域的交换机上；边界路由器的相邻交换机上；重点保护网段的局域网交换机上。


2.项目的内容


3.项目实施的方法

4.技术条件

5.预期效果

6.进度安排















存在的问题：
1.车载设备的计算能力和网络流量大小大致在什么范围？
可否满足机器学习的处理能力，较快的计算出结果；
流量大小决定采用包还是流的形式。

2.对于攻击是分析后警报还是阻断，阻断会在多大程度上影响网络性能？

3.数据存放的形式，文本、数据库还是其他形式？

4.检测时间是在包传输完成后，不阻断包的传输过程。

5.机器学习对单个样本的预测不是100%准确的。

6.检测结果的实时性。

7.博士论文到底能否检测出入侵的行为。



8.使用基于规则的检测，检测出的异常占总异常的比例能达到多少，怎么增加规则。

F:\RTOS上建立入侵检测系统\machine-learning-techniques-for-flow-based-network-intrusion-detection-systems-master

20190731000322743
Tm8_aeQk7T3SkWe83meG
